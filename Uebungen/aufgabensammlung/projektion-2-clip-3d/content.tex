\bivtask{3D-Clipping für perspektivische Projektion}{12}\label{aufgabe:proj2}
%
Die Projektion aus Aufgabe~\ref{aufgabe:proj1} enthielt noch einige 
Vereinfachungen. So wurde die $z$-Koordinate vernachlässigt und kein 
Clipping in normalisierten Sichtkoordinaten durchgeführt.

Das Rahmenprogramm \texttt{proj2.cc} im Verzeichnis 
\bivfolder{/home/bildgen/Aufgaben/projektion-2} enthält alle Schritte 
für den allgemeinen Fall. Ihre Aufgabe ist, das fehlende Clipping zu 
ergänzen. Sie sollen hierbei keine optimierten Verfahren wie 
Cohen-Sutherland oder Cyrus-Beck-Liang-Barsky auf den 3D-Fall 
übertragen. Gehen Sie einfach von den Parameterdarstellungen der Gerade 
aus, d.\,h.\
\[ x(t) = x₀ + t (x₁ - x₀), \quad y(t) = y₀ + t (y₁ - y₀), \quad
z(t) = z₀ + t (z₁ - z₀), \quad 0 ≤ t ≤ 1 \,\text. \]
Alle notwendigen Parameter und Daten sind im Code vorgegeben. Für jede
Kante wird die Funktion \texttt{clip3D} aufgerufen. Die Endpunkte der 
unbearbeiteten Kante werden als Referenz via \texttt{anf} und 
\texttt{end} übergeben. Führen Sie nun für die jeweilige Kante 
\emph{nacheinander} Clipping an den Clip\-ping\-ebe\-nen in 
normalisierten Sichtkoordinaten aus. Aktualisieren Sie dann 
\texttt{anf} und \texttt{end} mit den neuen Endpunkten der geclippten
Kante.

\begin{enumerate}
\item $-1 ≤ z ≤ z_\text{min}$

      Bestimmen Sie die Schnittpositionen $t₁$, $t₂$ mit der Front- und
      Backplane aus $z(t₁) = -1$ und $z(t₂) = z_\text{min}$. Beachten 
      Sie auch den Sonderfall für Geraden, die in der $x$-$y$-Ebene 
      liegen.

\item\label{it:clip3dzx} $z ≤ x ≤ -z$

      Bestimmen Sie $t₁$, $t₂$ aus $x(t₁) = z(t₁)$ und $x(t₂) = -z(t₂)$.

      Überlegen Sie sich, welche verschiedenen Lagen eine Kante und ihre
      Endpunkte haben kann, so dass sie die zulässige (graue) Fläche
      schneidet (siehe Illustration). Dokumentieren Sie die 
      verschiedenen Fälle entweder in Ihrem Quelltext oder mit Hilfe 
      separater Zeichnungen (oder beides). Beachten Sie hier den 
      Sonderfall, dass die Gerade parallel zur $y$-Achse liegt.

\item $z ≤ y ≤ -z$

      Analog zu Fall~\ref{it:clip3dzx}.
\end{enumerate}

%\clearpage
Testen Sie das Programm mit den Dateien \texttt{Wuerfel?.info} (es ist
jeweils kommentiert, welcher Teil ausgeblendet werden sollte), 
\texttt{Colosseum?.info} und \texttt{sts1.info} sowie den zugehörigen 
Modellen \texttt{Wuerfel.in}, \texttt{Colosseum.in} und \texttt{sts.in}.
Hierzu müssen Sie Ihr Programm z.B. wie folgt aufrufen:
\begin{alltt}
   cat Wuerfel.in Wuerfel1.info | proj2
\end{alltt}

%Beachten Sie, dass die Eingabedateien aus Aufgabe~11 nicht verwendet
%werden können und neue auf der Webseite bereitstehen.
\begin{center}
  \resizebox{250pt}{!}{%
    \input{clip3d}%₁₂
  }%
\end{center}
